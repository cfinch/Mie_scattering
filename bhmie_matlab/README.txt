These codes are from Krzszystof Markowicz home page at IGf UW